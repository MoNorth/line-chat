!function(t){function a(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}var e={};a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},a.p="",a(a.s=0)}([function(t,a,e){t.exports=e(1)},function(t,a,e){"use strict";function i(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function t(t,a){for(var e=0;e<a.length;e++){var i=a[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(a,e,i){return e&&t(a.prototype,e),i&&t(a,i),a}}(),r=function(){function t(a,e){if(i(this,t),e){var n=Object.prototype.toString.call(a);if("[object String]"===n)this.dom=a,this.$=document.querySelector(a);else{if("[object Object]"!==n)throw"dom非法";this.dom=n.id||"",this.$=n}}else e=a,this.dom="#line-chat",this.$=document.querySelector(this.dom);this.param={type:"line",width:"100%",height:"100%",space:20,line:{style:"#fff",width:1,arcR:2,num:4,alpha:1,anim:150},point:{outStyle:"#fff",inStyle:"#0FC69B",outR:6,inR:4,alpha:1},Bezier:{style:"#fff",width:2,alpha:1,bg:"#3477BB",bgAlpha:1},data:{y:[0,0],hasPoint:[]},shan:{sr:30,scolor:"#fff",color:[]}},this._extend(this.param,e)}return n(t,[{key:"_extend",value:function(t,a){for(var e in a){var i=Object.prototype.toString.call(a[e]);"[object Array]"===i||"[object Object]"===i?this._extend(t[e],a[e]):t[e]=a[e]}}},{key:"init",value:function(){var t=this.canvas=document.createElement("canvas"),a=this.$.clientWidth,e=this.$.clientHeight;if(~(this.param.width+"").indexOf("%")){var i=parseInt(this.param.width);t.width=a*i/100}else t.width=this.param.width;if(~(this.param.height+"").indexOf("%")){var n=parseInt(this.param.height);t.height=e*n/100}else t.height=this.param.height;if(!t.getContext)throw"浏览器不支持";switch(this.ctx=t.getContext("2d"),this.param.type){case"shan":this.drawShan();break;default:this.drawLine()}this.$.appendChild(t)}},{key:"go",value:function(){switch(this.param.type){case"shan":this.drawShan();break;default:this.animDranLine()}}},{key:"drawShan",value:function(){this._computeArc(),this.computeShanData=this._computeShanData(),this._drawShan()}},{key:"_drawShan",value:function(){var t=this,a=this.param.shan,e=a.sr,i=a.color,n=a.br,r=a.x,h=a.y,o=a.scolor;this.computeShanData.forEach(function(a,e){t._drawShanB(r,h,n,a.begin,a.end,i[e])}),this._drawShanB(r,h,e,0,2*Math.PI,o)}},{key:"_drawShanB",value:function(t,a,e,i,n,r){var h=this.ctx;r||(r=this.getRandomColor()),h.save(),h.beginPath(),h.moveTo(t,a),h.fillStyle=r,h.arc(t,a,e,i,n),h.fill(),h.closePath(),h.restore()}},{key:"getRandomColor",value:function(){return"#"+[0,0,0,0,0,0].map(function(){return"0123456789abcdef".charAt(Math.floor(16*Math.random()))}).join("")}},{key:"_computeShanData",value:function(){var t=this.param.data.y||[],a=t.reduce(function(t,a){return t+a}),e=2*Math.PI,i=0;return t.map(function(t){var n=i,r=i+t/a*e;return i=r,{begin:n,end:r}})}},{key:"_computeArc",value:function(){var t=this.canvas.width,a=this.canvas.height;this.param.shan.br=t>a?a/2:t/2,this.param.shan.x=t/2,this.param.shan.y=a/2}},{key:"animDranLine",value:function(){var t=this,a=this.param.line.anim,e=this.canvas.height/3,i=0,n=16*e/a,r=this.ctx;this.computedPoint=this._compute(),this.drawPoint=this._getControlPoint(this.computedPoint);var h=function(a,e){r.translate(0,a),r.clearRect(0,0,t.canvas.width,t.canvas.height),t._drawLine(),r.translate(0,e),t._drawBezier(),t._drawPoint()},o=setInterval(function(){if(h(i,e),i=-1*e,(e-=n)<-20){clearInterval(o);var t=setInterval(function(){h(i,e),i=-1*e,(e+=n/8)>0&&(clearInterval(t),h(i,0))})}},16)}},{key:"drawLine",value:function(){this._drawLine(),this.computedPoint=this._compute(),this.drawPoint=this._getControlPoint(this.computedPoint),this._drawBezier(),this._drawPoint()}},{key:"_drawBezier",value:function(){var t=this.ctx,a=this.computedPoint,e=this.drawPoint,i=this.param.Bezier,n=i.style,r=i.width,h=i.alpha,o=i.bg,s=i.bgAlpha;t.save(),t.beginPath(),t.strokeStyle=n,t.lineWidth=r,t.globalAlpha=h,t.fillStyle=o,t.moveTo(a[0].x,a[0].y),e.forEach(function(a){var e=a.cp1x,i=a.cp1y,n=a.cp2x,r=a.cp2y,h=a.x,o=a.y;t.bezierCurveTo(e,i,n,r,h,o)}),t.stroke(),t.globalAlpha=s,t.lineTo(this.canvas.width-this.param.point.outR,this.canvas.height-this.param.line.arcR),t.lineTo(this.param.point.outR,this.canvas.height-this.param.line.arcR),t.lineTo(a[0].x,a[0].y),t.fill(),t.closePath(),t.restore()}},{key:"_drawLine",value:function(){var t=this._getPointByLine(),a=this.ctx,e=this.param.line,i=e.style,n=e.width,r=e.arcR,h=e.alpha;a.save(),a.beginPath(),a.strokeStyle=i,a.fillStyle=i,a.lineWidth=n,a.globalAlpha=h,t.forEach(function(t){a.moveTo(t.x1,t.y1),a.lineTo(t.x2,t.y2)}),a.stroke(),t.forEach(function(t){a.moveTo(t.x1,t.y1),a.arc(t.x1,t.y1,r,0*Math.PI,2*Math.PI),a.moveTo(t.x1,t.y1),a.arc(t.x2,t.y2,r,0*Math.PI,2*Math.PI)}),a.fill(),a.closePath(),a.restore()}},{key:"_drawPoint",value:function(){var t=this.computedPoint,a=this.ctx,e=this.param.point,i=e.outStyle,n=e.inStyle,r=e.outR,h=e.inR,o=e.alpha,s=this.param.data.hasPoint;a.save(),a.beginPath(),a.fillStyle=i,a.globalAlpha=o,t.forEach(function(t,e){~s.indexOf(e)&&(a.moveTo(t.x,t.y),a.arc(t.x,t.y,r,0*Math.PI,2*Math.PI))}),a.fill(),a.closePath(),a.beginPath(),a.fillStyle=n,t.forEach(function(t,e){~s.indexOf(e)&&(a.moveTo(t.x,t.y),a.arc(t.x,t.y,h,0*Math.PI,2*Math.PI))}),a.fill(),a.closePath(),a.restore()}},{key:"_getPointByLine",value:function(){for(var t=[],a=this.param.line,e=a.num,i=a.arcR,n=this.param.point.outR,r=this.canvas.width-(n-i),h=this.canvas.height-2*i,o=h/e,s=i;s<=h+2*i;)t.push({x1:n-i,y1:s,x2:r,y2:s}),s+=o;return t}},{key:"_compute",value:function(){var t=this,a=this.param.data.y||[],e=this.param.point.outR,i=a.length,n=this.canvas.height/2-this.param.space,r=this.canvas.width-2*e,h=r/(i-1),o=e,s=n/Math.abs(this._findMax(a)-a[0]);return a.map(function(e){return(a[0]-e)*s+n+t.param.space}).map(function(t){var a=o;return o+=h,{x:a,y:t}})}},{key:"_findMax",value:function(t){var a=t.concat([]);return a.sort(function(a,e){return Math.abs(e-t[0])-Math.abs(a-t[0])}),a[0]||1}},{key:"_getControlPoint",value:function(t){var a=0,e=t.length-2,i=[],n=this.computedPoint;if(e<1)return n.map(function(t){return{cp1x:t.x,cp1y:t.y,cp2x:t.x,cp2y:t.y,x:t.x,y:t.y}});for(;a<e;a++){var r=t[a],o=t[a+1],s=t[a+2],c=new h(r.x-o.x,r.y-o.y),l=new h(s.x-o.x,s.y-o.y),u=c.length(),p=l.length(),y=c.normalize().add(l.normalize()).normalize(),f=new h(y.y,-1*y.x),d=new h(-1*y.y,y.x);if(f.angle(c)<90){var v=f.multiply(.3*u).add(o),m=d.multiply(.3*p).add(o);i.push(v,m)}else{var x=f.multiply(.3*p).add(o),g=d.multiply(.3*u).add(o);i.push(g,x)}}var w=[];return a=0,n.forEach(function(t,e){e===n.length-1?w.push({cp1x:i[a].x,cp1y:i[a].y,cp2x:t.x,cp2y:t.y,x:t.x,y:t.y}):0===e||(1===e?(w.push({cp1x:i[a].x,cp1y:i[a].y,cp2x:t.x,cp2y:t.y,x:t.x,y:t.y}),a+=1):(w.push({cp1x:i[a].x,cp1y:i[a].y,cp2x:i[a+1].x,cp2y:i[a+1].y,x:t.x,y:t.y}),a+=2))}),w}}]),t}();a.default=r;var h=function(){function t(a,e){i(this,t),this.x=a,this.y=e}return n(t,[{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"normalize",value:function(){var a=1/this.length();return new t(this.x*a,this.y*a)}},{key:"add",value:function(a){return new t(this.x+a.x,this.y+a.y)}},{key:"multiply",value:function(a){return new t(this.x*a,this.y*a)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"angle",value:function(t){return 180*Math.acos(this.dot(t)/(this.length()*t.length()))/Math.PI}}]),t}();window&&(window.lineChat=r)}]);