!function(t){function e(a){if(i[a])return i[a].exports;var n=i[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,a){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),r=function(){function t(e,i){if(a(this,t),i){var n=Object.prototype.toString.call(e);if("[object String]"===n)this.dom=e,this.$=document.querySelector(e);else{if("[object Object]"!==n)throw"dom非法";this.dom=n.id||"",this.$=n}}else i=e,this.dom="#line-chat",this.$=document.querySelector(this.dom);this.param={width:"100%",height:"100%",space:20,line:{style:"#fff",width:1,arcR:2,num:4,alpha:1},point:{outStyle:"#fff",inStyle:"#0FC69B",outR:6,inR:4,alpha:1},Bezier:{style:"#fff",width:2,alpha:1,bg:"#3477BB",bgAlpha:1},data:{y:[],hasPoint:[]}},this._extend(this.param,i)}return n(t,[{key:"_extend",value:function(t,e){for(var i in e){var a=Object.prototype.toString.call(e[i]);"[object Array]"===a||"[object Object]"===a?this._extend(t[i],e[i]):t[i]=e[i]}}},{key:"init",value:function(){var t=this.canvas=document.createElement("canvas"),e=this.$.clientWidth,i=this.$.clientHeight;if(~(this.param.width+"").indexOf("%")){var a=parseInt(this.param.width);t.width=e*a/100}else t.width=this.param.width;if(~(this.param.height+"").indexOf("%")){var n=parseInt(this.param.height);t.height=i*n/100}else t.height=this.param.height;if(!t.getContext)throw"浏览器不支持";this.ctx=t.getContext("2d"),this.draw(),this.$.appendChild(t)}},{key:"draw",value:function(){this._drawLine(),this.computedPoint=this._compute(),this.drawPoint=this._getControlPoint(this.computedPoint),this._drawBezier(),this._drawPoint()}},{key:"_drawBezier",value:function(){var t=this.ctx,e=this.computedPoint,i=this.drawPoint,a=this.param.Bezier,n=a.style,r=a.width,o=a.alpha,h=a.bg,l=a.bgAlpha;t.save(),t.beginPath(),t.strokeStyle=n,t.lineWidth=r,t.globalAlpha=o,t.fillStyle=h,t.moveTo(e[0].x,e[0].y),i.forEach(function(e){var i=e.cp1x,a=e.cp1y,n=e.cp2x,r=e.cp2y,o=e.x,h=e.y;t.bezierCurveTo(i,a,n,r,o,h)}),t.stroke(),t.globalAlpha=l,t.lineTo(this.canvas.width-this.param.point.outR,this.canvas.height-this.param.line.arcR),t.lineTo(this.param.point.outR,this.canvas.height-this.param.line.arcR),t.lineTo(e[0].x,e[0].y),t.fill(),t.closePath(),t.restore()}},{key:"_drawLine",value:function(){var t=this._getPointByLine(),e=this.ctx,i=this.param.line,a=i.style,n=i.width,r=i.arcR,o=i.alpha;e.save(),e.beginPath(),e.strokeStyle=a,e.fillStyle=a,e.lineWidth=n,e.globalAlpha=o,t.forEach(function(t){e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2)}),e.stroke(),t.forEach(function(t){e.moveTo(t.x1,t.y1),e.arc(t.x1,t.y1,r,0*Math.PI,2*Math.PI),e.moveTo(t.x1,t.y1),e.arc(t.x2,t.y2,r,0*Math.PI,2*Math.PI)}),e.fill(),e.closePath(),e.restore()}},{key:"_drawPoint",value:function(){var t=this.computedPoint,e=this.ctx,i=this.param.point,a=i.outStyle,n=i.inStyle,r=i.outR,o=i.inR,h=i.alpha,l=this.param.data.hasPoint;e.save(),e.beginPath(),e.fillStyle=a,e.globalAlpha=h,t.forEach(function(t,i){~l.indexOf(i)&&(e.moveTo(t.x,t.y),e.arc(t.x,t.y,r,0*Math.PI,2*Math.PI))}),e.fill(),e.closePath(),e.beginPath(),e.fillStyle=n,t.forEach(function(t,i){~l.indexOf(i)&&(e.moveTo(t.x,t.y),e.arc(t.x,t.y,o,0*Math.PI,2*Math.PI))}),e.fill(),e.closePath(),e.restore()}},{key:"_getPointByLine",value:function(){for(var t=[],e=this.param.line,i=e.num,a=e.arcR,n=this.param.point.outR,r=this.canvas.width-(n-a),o=this.canvas.height-2*a,h=o/i,l=a;l<=o+2*a;)t.push({x1:n-a,y1:l,x2:r,y2:l}),l+=h;return t}},{key:"_compute",value:function(){var t=this,e=this.param.data.y||[],i=this.param.point.outR,a=e.length,n=this.canvas.height/2-this.param.space,r=this.canvas.width-2*i,o=r/(a-1),h=i,l=n/this._findMax(e);return e.map(function(i){return(e[0]-i)*l+n+t.param.space}).map(function(t){var e=h;return h+=o,{x:e,y:t}})}},{key:"_findMax",value:function(t){var e=t.concat([]);return e.sort(function(e,i){return Math.abs(i-t[0])-Math.abs(e-t[0])}),e[0]||1}},{key:"_getControlPoint",value:function(t){for(var e=0,i=t.length-2,a=[];e<i;e++){var n=t[e],r=t[e+1],h=t[e+2],l=new o(n.x-r.x,n.y-r.y),s=new o(h.x-r.x,h.y-r.y),c=l.length(),u=s.length(),p=l.normalize().add(s.normalize()).normalize(),y=new o(p.y,-1*p.x),f=new o(-1*p.y,p.x);if(y.angle(l)<90){var d=y.multiply(.3*c).add(r),x=f.multiply(.3*u).add(r);a.push(d,x)}else{var v=y.multiply(.3*u).add(r),m=f.multiply(.3*c).add(r);a.push(m,v)}}var g=this.computedPoint,w=[];return e=0,g.forEach(function(t,i){i===g.length-1?w.push({cp1x:a[e].x,cp1y:a[e].y,cp2x:t.x,cp2y:t.y,x:t.x,y:t.y}):0===i||(1===i?(w.push({cp1x:a[e].x,cp1y:a[e].y,cp2x:t.x,cp2y:t.y,x:t.x,y:t.y}),e+=1):(w.push({cp1x:a[e].x,cp1y:a[e].y,cp2x:a[e+1].x,cp2y:a[e+1].y,x:t.x,y:t.y}),e+=2))}),w}}]),t}();e.default=r;var o=function(){function t(e,i){a(this,t),this.x=e,this.y=i}return n(t,[{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"normalize",value:function(){var e=1/this.length();return new t(this.x*e,this.y*e)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"multiply",value:function(e){return new t(this.x*e,this.y*e)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"angle",value:function(t){return 180*Math.acos(this.dot(t)/(this.length()*t.length()))/Math.PI}}]),t}();window&&(window.lineChat=r)}]);